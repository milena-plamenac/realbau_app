@model IEnumerable<realbau_app.Models.AddressDetails>
@{
    ViewBag.Title = "Index";
}
<h4 class="center-align">Active addresses<br /></h4>
@*<form id="addresses" asp-controller="Home" asp-action="Addresses" method="POST">*@
@* using (Html.BeginForm("Addresses", "Home", FormMethod.Post))
    {*@

@* <div class="row" >
            <div class="col s3 m3 l3 input-field "><input class="form-control validate" id="cityFilter" /><label for="cityFilter"></label></div>
            <div class="col s3 m3 l3 input-field "><input class="form-control validate" id="popFilter" /><label for="popFilter"></label></div>
        </div>*@

<span id="show"></span>

<div class="row">
    <div class="col s12 m12 l12">
        <div class="card">
            <div class="card-content">
                <span class="card-title">Filters</span>
                <div class="row">
                    <div class="input field col s12 m6 l3">
                        <input class="materialize-input" id="cityFilter" />
                        <label for="cityFilter">Filter by city</label>
                    </div>
                    <div class="input field col s12 m6 l3">
                        <input class="materialize-input" id="popFilter" />
                        <label for="popFilter">Filter by pop</label>
                    </div>
                    <div col s12 m6 l6>
                        <h5>Get data</h5>
                        <button class="btn">HB not done</button>
                    </div>
                    @* <div class="col s12 m6 l1">

                    <p>
                    <label>
                    <input type="checkbox" class="filled-in" id="hbFilter" />
                    <span>Hausbegehung</span>
                    </label>
                    </p>
                    </div>
                    <div class="col s12 m6 l1">

                    <p>
                    <label>
                    <input type="checkbox" class="filled-in" id="tFilter" />
                    <span>Tiefbau</span>
                    </label>
                    </p>
                    </div>
                    <div class="col s12 m6 l1">

                    <p>
                    <label>
                    <input type="checkbox" class="filled-in" id="fFilter" />
                    <span>Faser</span>
                    </label>
                    </p>
                    </div>
                    <div class="col s12 m6 l1">

                    <p>
                    <label>
                    <input type="checkbox" class="filled-in" id="mFilter" />
                    <span>Montaze</span>
                    </label>
                    </p>
                    </div>
                    <div class="col s12 m6 l1">

                    <p>
                    <label>
                    <input type="checkbox" class="filled-in" id="aFilter" />
                    <span>Aktivirung</span>
                    </label>
                    </p>
                    </div>
                    <div class="col s12 m6 l1">

                    <p>
                    <label>
                    <input type="checkbox" class="filled-in" id="vFilter" />
                    <span>Vermessung</span>
                    </label>
                    </p>
                    </div>*@
                </div>

                @*<div class="row">
                <div class="col s12 m12 l12">
                <form asp-route="StreamFileUpload/Index" enctype="multipart/form-data" method="POST">
                <input type="file" name="file" />
                <button type="submit" class="btn btn-primary">Save</button>
                </form>
                </div>
                </div>*@


            </div>
            <div class="card-action">
                <a class="waves-effect waves-light btn" id="filter" style="background-color: #4db6ac; color: whitesmoke !important;">Filter data</a>
                <a class="waves-effect waves-light btn" id="reset" style="background-color: #e57373; color: whitesmoke !important;">Reset filter</a>

            </div>
        </div>
    </div>
</div>

<style>
    /*i {
                                                                                                                                                        color: darkgreen !important;
                                                                                                                                                    }*/

    table {
        margin: 1rem !important;
    }

    span {
        display: inline-block;
        margin: 10px;
        overflow: hidden;
    }

    .nameSpan {
        width: 100px !important;
        /*border: 1px solid red;*/
        /*overflow: hidden;*/
    }

    .citySpan {
        width: 120px !important;
        /*border: 1px solid blue;*/
        /*overflow: hidden;*/
    }

    .areapopSpan {
        width: 80px !important;
        /*border: 1px solid blue;*/
        /*overflow: hidden;*/
    }

    .addressSpan {
        width: 340px !important;
        /*border: 1px solid blue;*/
        /*overflow: hidden;*/
    }

    .phoneSpan {
        width: 140px !important;
        /*border: 1px solid blue;*/
        /*overflow: hidden;*/
    }

    .emailSpan {
        width: 160px !important;
        /*border: 1px solid blue;*/
        /*overflow: hidden;*/
    }

    .finishedSpan {
        width: 75px !important;
        /*border: 1px solid blue;*/
        /*overflow: hidden;*/
    }

    .save-changes-btn {
        background-color: #0288d1;
    }

    .finished-btn {
        margin: 10px;
    }

    .term-btn {
        background-color: #fffde7;
        color: #37474f;
        color: grey;
        margin: 10px;
    }

    .call-btn {
        background-color: #fff8e1;
        color: #37474f;
        color: grey;
        margin: 10px;
    }

    .image-btn {
        background-color: #fff3e0;
        color: #37474f;
        color: grey;
    }

    #hausbegehungLink, #tiefbauLink, #faserLink, #montazeLink, #aktivirungLink, #vermessungLink {
        color: grey;
        font-weight: bold;
    }

    #hbGetTerm, #hbFinished, #hbCustomerCalled, #hbAddImage, #hbSaveChanges,
    #tGetTerm, #tFinished, #tCustomerCalled, #tAddImage, #tSaveChanges,
    #mGetTerm, #mFinished, #mCustomerCalled, #mAddImage, #mSaveChanges,
    #aGetTerm, #aFinished, #aCustomerCalled, #aAddImage, #aSaveChanges,
    #fGetTerm, #fFinished, #fCustomerCalled, #fAddImage, #fSaveChanges,
    #fGetTerm, #fFinished, #fCustomerCalled, #fAddImage, #fSaveChanges {
        margin: 10px;
    }
</style>
@*
<ul class="collapsible">
    <li>
        <div class="collapsible-header"><i class="material-icons">filter_drama</i>First</div>
        <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
    </li>
    <li>
        <div class="collapsible-header"><i class="material-icons">place</i>Second</div>
        <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
    </li>
    <li>
        <div class="collapsible-header"><i class="material-icons">whatshot</i>Third</div>
        <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
    </li>
</ul>*@

@*<table class="table table-responsive" id="newaddresses">*@
@*    <tr>
    <th>name</th>
    <th>email</th>
    <th>phone</th>
    <th>phone2</th>
    <th>city</th>
    <th>tzip</th>
    <th>street</th>
    <th>house number</th>
    <th>unit</th>
    <th>areapop</th>
    <th>hausbegehung</th>
    <th>tiefbau</th>
    <th>faser</th>
    <th>montaze</th>
    <th>aktivirung</th>
    <th>vermessung</th>
    <th></th>

    </tr>*@
<ul class="collapsible">
    @foreach (var address in Model)
    {

        <li class="header_li">
            <div class="collapsible-header" id="header_@address.id">
                <div class="row" style="margin: 0">
                    @*<div class="col s1 m1 l1">*@
                    <span class="citySpan" id="citySpan_@address.id">@address.city</span>
                    <span class="areapopSpan" id="areapopSpan_@address.id">@address.areapop</span>
                    <span class="nameSpan">@address.name</span>
                    <span class="addressSpan">@address.street, @address.housenumber @address.subnumber, @address.unit</span>
                    <span class="phoneSpan">@address.phone</span>
                    <span class="phoneSpan">@address.phone2</span>
                    <span class="emailSpan">@address.email</span>
                    @*</div>*@
                    @if (address.hbfinished == 1)
                    {

                        <span class="finishedSpan"><b>HB:</b> <i class="material-icons" style="color: green !important">check</i></span>

                    }
                    else
                    {

                        <span class="finishedSpan"><b>HB:</b> <i class="material-icons" style="color: red !important">clear</i></span>

                    }

                    @if (address.tfinished == 1)
                    {

                        <span class="finishedSpan"><b>T:</b> <i class="material-icons" style="color: green !important">check</i></span>

                    }
                    else
                    {

                        <span class="finishedSpan"><b>T:</b> <i class="material-icons" style="color: red !important">clear</i></span>

                    }

                    @if (address.ffinished == 1)
                    {

                        <span class="finishedSpan"><b>F:</b> <i class="material-icons" style="color: green !important">check</i></span>

                    }
                    else
                    {

                        <span class="finishedSpan"><b>F:</b> <i class="material-icons" style="color: red !important">clear</i></span>

                    }

                    @if (address.mfinished == 1)
                    {

                        <span class="finishedSpan"><b>M:</b> <i class="material-icons" style="color: green !important">check</i></span>

                    }
                    else
                    {

                        <span class="finishedSpan"><b>M:</b> <i class="material-icons" style="color: red !important">clear</i></span>

                    }

                    @if (address.afinished == 1)
                    {

                        <span class="finishedSpan"><b>A:</b> <i class="material-icons" style="color: green !important">check</i></span>

                    }
                    else
                    {

                        <span class="finishedSpan"><b>A:</b> <i class="material-icons" style="color: red !important">clear</i></span>

                    }

                    @if (address.vfinished == 1)
                    {

                        <span class="finishedSpan"><b>V:</b> <i class="material-icons" style="color: green !important">check</i></span>

                    }
                    else
                    {

                        <span class="finishedSpan"><b>V:</b> <i class="material-icons" style="color: red !important">clear</i></span>

                    }

                </div>
            </div>
            <div class="collapsible-body">
                <div class="row">
                    <div class="col s12">
                        <ul class="tabs">
                            <li class="tab col s2"><a href="#hausbegehung_@address.id" class="active">Hausbegehung</a></li>
                            <li class="tab col s1"><a href="#hbterms_@address.id" class="hbTerms" id="@address.city @address.areapop @address.id">HB terms</a></li>
                            <li class="tab col s1"><a href="#tiefbau_@address.id">Tiefbau</a></li>
                            <li class="tab col s1"><a href="#faser_@address.id">Faser</a></li>
                            <li class="tab col s1"><a href="#montaze_@address.id">Montaze</a></li>
                            <li class="tab col s1"><a href="#aktivirung_@address.id">Aktivirung</a></li>
                            <li class="tab col s2"><a href="#vermessung_@address.id">Vermessung</a></li>
                        </ul>
                    </div>
                    @*First suggestion*@
                    @*<div id="hausbegehung_@address.id" class="col s12">
                <div class="row">
                <div class="col s12 m12 l12">
                <div class="row">
                <div class="col s6 m6 l6">
                <p>Date: @address.hbdate?.ToString("dd.MM.yyyy")</p>
                <p>Termin: @address.hbfrom?.ToString("HH:mm") - @address.hbto?.ToString("HH:mm")</p>
                <p>Call date: <span id="hbCallDate_@address.id">@address.hbcalldate?.ToString("dd.MM.yyyy HH:mm")</span></p>
                </div>
                <div class="col s6 m6 l6">
                <textarea class="materialize-textarea" id="hbComment_@address.id">@address.hbcomment</textarea>
                <label for="hbComment_@address.id">Hausbegehung comment</label>

                </div>
                </div>



                <a class="waves-effect waves-light btn hbSaveChanges" disabled="@(address.hbfinished == 1)" id="hbSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                <a class="waves-effect waves-light btn hbFinished" disabled="@(address.hbfinished == 1)" id="hbFinished_@address.id"><i class="material-icons left">check</i>HB finished</a>
                <a class="waves-effect waves-light btn hbGetTerm" disabled="@(address.hbfinished == 1)" id="hbGetTerm_@address.id"><i class="material-icons left">date_range</i>Get HB term</a>
                <a class="waves-effect waves-light btn hbCustomerCalled" disabled="@(address.hbfinished == 1)" id="hbCustomerCalled_@address.id"><i class="material-icons left">phone</i>Customer called</a>
                <a class="waves-effect waves-light btn hbAddImage" disabled="@(address.hbfinished == 1)" id="hbAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                </div>
                </div>
                </div>*@

                    <div id="hausbegehung_@address.id" class="col s12">
                        <div class="row">
                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0;">
                                @*<div class="card">
                            <div class="card-content">*@
                                <h6><b>HB information</b></h6>

                                <p>Date: @address.hbdate?.ToString("dd.MM.yyyy")</p>
                                <p>Termin: @address.hbfrom?.ToString("HH:mm") - @address.hbto?.ToString("HH:mm")</p>
                                @*<p>Call date: <span id="hbCallDate_@address.id">@address.hbcalldate?.ToString("dd.MM.yyyy HH:mm")</span></p>*@
                                <a title="Please, check that hausbegehung is finished" class="waves-effect waves-light btn hbFinished" disabled="@(address.hbfinished == 1)" id="hbFinished_@address.id"><i class="material-icons left">check</i>HB is finished</a>
                                <a title="Go to link that customer will get on email" class="waves-effect waves-light btn hbGetTerm" disabled="@(address.hbfinished == 1)" id="hbGetTerm_@address.id"><i class="material-icons left">date_range</i>HB term link</a>
                                <a class="waves-effect waves-light btn hbAddImage" disabled="@(address.hbfinished == 1)" id="hbAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                                @* </div>
                            </div>*@
                            </div>


                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0;">
                                @*<div class="card">
                            <div class="card-content">*@
                                <h6><b>HB customer contact</b></h6>

                                <span>Call date:</span> <span id="hbCallDate_@address.id">@address.hbcalldate?.ToString("dd.MM.yyyy HH:mm")</span>
                                <br>
                                <a style="margin-top: 20px;" title="Please, click when customer is called!" class="waves-effect waves-light btn hbCustomerCalled" disabled="@(address.hbfinished == 1)" id="hbCustomerCalled_@address.id">
                                    <i class="material-icons left">phone</i>Customer called
                                </a>
                                @*</div>
                            </div>*@
                            </div>

                            <div class="col s12 m4 l4">
                                @*<div class="card">
                            <div class="card-content">*@
                                <h6><b>HB comment</b></h6>
                                <h6></h6>
                                <textarea class="materialize-textarea" id="hbComment_@address.id">@address.hbcomment</textarea>
                                <label for="hbComment_@address.id">Hausbegehung comment</label>
                                <br>
                                <a style="margin-top: 20px;" class="waves-effect waves-light btn hbSaveChanges" disabled="@(address.hbfinished == 1)" id="hbSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                                @* </div>
                            </div>*@
                            </div>

                        </div>
                    </div>

                    <div id="hbterms_@address.id" class="col s12">
                        <div class="row">
                            <div class="center-align col s12 m4 l4">
                                @*<div>
                            <a href="#">Prev. date</a>
                            <input type="text" style="width: auto;" />
                            <a href="#">Next date</a>
                            </div>*@

                                @*<div class="card">
                            <div class="card-content">

                            <div class="row">


                            <div class="col s12 m6 l6">
                            <input id="currentdate" type="text">
                            <label for="currentdate">Date</label>
                            <button class="btn datepicker" value="Choose date"></button>

                            <button class="btn">Filter</button>
                            </div>



                            </div>
                            </div>
                            </div>*@
                                <div class="input-field">
                                    <input id="termsDate_@address.id" type="text" class="validate center-align" disabled>
                                </div>
                                <table class="table table-bordered table-responsive table-hover" id="tblHbTerms">
                                    <thead>
                                        <tr>
                                            <th hidden>Id</th>
                                            <th>From</th>
                                            <th>To</th>
                                            <th>Busy</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>

                            <div class="center-align col s12 m4 l4">
                                @*<div>
                            <a href="#">Prev. date</a>
                            <input type="text" style="width: auto;" />
                            <a href="#">Next date</a>
                            </div>*@

                                @*<div class="card">
                            <div class="card-content">

                            <div class="row">


                            <div class="col s12 m6 l6">
                            <input id="currentdate" type="text">
                            <label for="currentdate">Date</label>
                            <button class="btn datepicker" value="Choose date"></button>

                            <button class="btn">Filter</button>
                            </div>



                            </div>
                            </div>
                            </div>*@
                                <div class="input-field">
                                    <input id="termsDate_1_@address.id" type="text" class="validate center-align" disabled>
                                </div>
                                <table class="table table-bordered table-responsive table-hover" id="tblHbTerms_1">
                                    <thead>
                                        <tr>
                                            <th hidden>Id</th>
                                            <th>From</th>
                                            <th>To</th>
                                            <th>Busy</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>

                            <div class="center-align col s12 m4 l4">
                                @*<div>
                            <a href="#">Prev. date</a>
                            <input type="text" style="width: auto;" />
                            <a href="#">Next date</a>
                            </div>*@

                                @*<div class="card">
                            <div class="card-content">

                            <div class="row">


                            <div class="col s12 m6 l6">
                            <input id="currentdate" type="text">
                            <label for="currentdate">Date</label>
                            <button class="btn datepicker" value="Choose date"></button>

                            <button class="btn">Filter</button>
                            </div>



                            </div>
                            </div>
                            </div>*@
                                <div class="input-field">
                                    <input id="termsDate_2_@address.id" type="text" class="validate center-align" disabled>
                                </div>
                                <table class="table table-bordered table-responsive table-hover" id="tblHbTerms_2">
                                    <thead>
                                        <tr>
                                            <th hidden>Id</th>
                                            <th>From</th>
                                            <th>To</th>
                                            <th>Busy</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="tiefbau_@address.id" class="col s12">
                        @*Suggestion 1*@
                        @*<div class="row">

                    <div class="col s12 m12 l12">

                    <div class="row">
                    <div class="col s6 m6 l6">
                    <textarea class="materialize-textarea" id="meter_@address.id">@address.meter</textarea>
                    <label for="meterInput">Meter</label>

                    </div>
                    <div class="col s6 m6 l6">
                    <textarea class="materialize-textarea" id="tComment_@address.id">@address.tcomment</textarea>
                    <label for="tCommentInput">Tiefbau comment</label>

                    </div>
                    </div>
                    <div class="row">
                    <div class="col s12 m12 l12">
                    <p>Date: <span id="tDate_@address.id">@address.tdate</span></p>
                    </div>
                    </div>

                    </div>

                    <a class="waves-effect waves-light btn tSaveChanges" disabled="@(address.tfinished == 1)" id="tSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                    <a class="waves-effect waves-light btn tFinished" disabled="@(address.tfinished == 1)" id="tFinished_@address.id"><i class="material-icons left">check</i>Tiefbau finished</a>
                    <a class="waves-effect waves-light btn tAddImage" disabled="@(address.tfinished == 1)" id="tAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>

                    </div>*@

                        @*Suggestion 2*@


                        <div class="row">
                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0;">
                                <h6><b>Tiefbau information</b></h6>
                                <span>Tiefbau finish date:</span><span id="tDate_@address.id">@address.tdate</span>
                                <br>
                                <a title="Click when tiefbau is ready" class="waves-effect waves-light btn tReady"
                               @{
                               if(address.tfinished == 1 || address.tready == 1) {
                                   @:disabled="disabled"
                               }
                               }
                               id="tReady_@address.id"><i class="material-icons left">check</i>Tiefbau ready</a>

                                <a title="Click when tiefbau is finished" class="waves-effect waves-light btn tFinished"
                               @{
                               if(address.tfinished == 1 || address.tready == 0) {
                                   @:disabled="disabled"
                               }
                               }
                               id="tFinished_@address.id"><i class="material-icons left">check</i>Tiefbau finished</a>
                                <a class="waves-effect waves-light btn tAddImage"
                               @{
                               if(address.tfinished == 1 || address.tready == 0) {
                                   @:disabled="disabled"
                               }
                               }
                               id="tAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                            </div>

                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0;">
                                <h6><b>Meter</b></h6>
                                <textarea class="materialize-textarea" id="meter_@address.id">@address.meter</textarea>
                                @*<label for="meterInput">Meter</label>*@
                                <a class="waves-effect waves-light btn tSaveChanges"
                               @{
                               if(address.tfinished == 1 || address.tready == 0) {
                                   @:disabled="disabled"
                               }
                               }
                               id="tSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                            </div>


                            <div class="col s12 m4 l4">
                                <h6><b>Tiefbau comment</b></h6>
                                <textarea class="materialize-textarea" id="tComment_@address.id">@address.tcomment</textarea>
                                @*<label for="tCommentInput">Tiefbau comment</label>*@
                                <a class="waves-effect waves-light btn tSaveChanges"
                               @{
                               if(address.tfinished == 1 || address.tready == 0) {
                                   @:disabled="disabled"
                               }
                               }
                               id="tSaveChanges1_@address.id"><i class="material-icons left">check</i>Save changes</a>
                            </div>
                        </div>





                    </div>

                    <div id="faser_@address.id" class="col s12">
                        @*<div class="row">
                    <div class="col s12 m12 l12" id="faserBody">
                    <div class="row">
                    <div class="col s6 m6 l6">
                    <p>Date: <span id="fDate_@address.id">@address.fdate</span></p>

                    </div>
                    <div class="col s6 m6 l6">
                    <textarea class="materialize-textarea" id="fComment_@address.id">@address.fcomment</textarea>
                    <label for="fComment_@address.id">Faser comment</label>

                    </div>
                    </div>
                    </div>
                    <a class="waves-effect waves-light btn fSaveChanges" disabled="@(address.ffinished == 1)" id="fSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                    <a class="waves-effect waves-light btn fFinished" disabled="@(address.ffinished == 1)" id="fFinished_@address.id"><i class="material-icons left">check</i>Faser finished</a>
                    <a class="waves-effect waves-light btn fAddImage" disabled="@(address.ffinished == 1)" id="fAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                    </div>*@



                        <div class="row">
                            <div class="col s12 m6 l6" style="border-right: 1px solid #e0e0e0">
                                <h6><b>Faser information</b></h6>
                                <span>Faser finish date: </span><span id="fDate_@address.id">@address.fdate</span>
                                <br>
                                <a class="waves-effect waves-light btn fFinished" disabled="@(address.ffinished == 1)" id="fFinished_@address.id"><i class="material-icons left">check</i>Faser finished</a>
                                <a class="waves-effect waves-light btn fAddImage" disabled="@(address.ffinished == 1)" id="fAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>

                            </div>
                            <div class="col s12 m6 l6">
                                <h6><b>Faser comment</b></h6>
                                <textarea class="materialize-textarea" id="fComment_@address.id">@address.fcomment</textarea>
                                @*<label for="fComment_@address.id">Faser comment</label>*@
                                <a class="waves-effect waves-light btn fSaveChanges" disabled="@(address.ffinished == 1)" id="fSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                            </div>
                        </div>




                    </div>


                    <div id="montaze_@address.id" class="col s12">

                        @*<div class="row">
                    <div class="col s12 m12 l12">
                    <div class="row">
                    <div class="col s6 m6 l6">
                    <p>Date: @address.mdate?.ToString("dd.MM.yyyy")</p>
                    <p>Termin: @address.mfrom?.ToString("HH:mm") - @address.mto?.ToString("HH:mm")</p>
                    <p>Call date: <span id="mCallDate_@address.id">@address.mcalldate?.ToString("dd.MM.yyyy HH:mm")</span></p>
                    </div>
                    <div class="col s6 m6 l6">
                    <textarea class="materialize-textarea" id="mComment_@address.id">@address.mcomment</textarea>
                    <label for="mComment_@address.id">Montaze comment</label>
                    </div>
                    </div>
                    </div>
                    <a class="waves-effect waves-light btn mSaveChanges" disabled="@(address.mfinished == 1)" id="mSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                    <a class="waves-effect waves-light btn mFinished" disabled="@(address.mfinished == 1)" id="mFinished_@address.id"><i class="material-icons left">check</i>Montaze finished</a>
                    <a class="waves-effect waves-light btn mGetTerm" disabled="@(address.mfinished == 1)" id="mGetTerm_@address.id"><i class="material-icons left">date_range</i>Get montaze term</a>
                    <a class="waves-effect waves-light btn mCustomerCalled" disabled="@(address.mfinished == 1)" id="mCustomerCalled_@address.id"><i class="material-icons left">phone</i>Customer called</a>
                    <a class="waves-effect waves-light btn mAddImage" disabled="@(address.mfinished == 1)" id="mAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                    </div>*@


                        <div class="row">
                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0;">
                                <h6><b>Montaze information</b></h6>
                                <p>Date: @address.mdate?.ToString("dd.MM.yyyy")</p>
                                <p>Termin: @address.mfrom?.ToString("HH:mm") - @address.mto?.ToString("HH:mm")</p>
                                <a title="Please, check when montaze is finished" class="waves-effect waves-light btn mFinished" disabled="@(address.mfinished == 1)" id="mFinished_@address.id"><i class="material-icons left">check</i>Montaze finished</a>
                                <a title="Go to page that user will get in email" class="waves-effect waves-light btn mGetTerm" disabled="@(address.mfinished == 1)" id="mGetTerm_@address.id"><i class="material-icons left">date_range</i>Montaze term link</a>
                                <a class="waves-effect waves-light btn mAddImage" disabled="@(address.mfinished == 1)" id="mAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                            </div>
                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0;">
                                <h6><b>Montaze contact</b></h6>
                                <span>Call date:</span><span id="mCallDate_@address.id">@address.mcalldate?.ToString("dd.MM.yyyy HH:mm")</span>
                                <br>
                                <a class="waves-effect waves-light btn mCustomerCalled" disabled="@(address.mfinished == 1)" id="mCustomerCalled_@address.id"><i class="material-icons left">phone</i>Customer called</a>
                            </div>
                            <div class="col s12 m4 l4">
                                <h6><b>Montaze comment</b></h6>
                                <textarea class="materialize-textarea" id="mComment_@address.id">@address.mcomment</textarea>
                                @*<label for="mComment_@address.id">Montaze comment</label>*@
                                <a class="waves-effect waves-light btn mSaveChanges" disabled="@(address.mfinished == 1)" id="mSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                            </div>
                        </div>





                    </div>

                    <div id="aktivirung_@address.id" class="col s12">

                        @*<div class="row">
                    <div class="col s12 m12 l12">
                    <div class="row">
                    <div class="col s6 m6 l6">
                    <p>Date: <span id="aDate_@address.id">@address.adate</span></p>
                    </div>
                    <div class="col s6 m6 l6">
                    <textarea class="materialize-textarea" id="aComment_@address.id">@address.acomment</textarea>
                    <label for="aComment_@address.id">Aktivirung comment</label>

                    </div>
                    </div>
                    </div>
                    <a class="waves-effect waves-light btn aSaveChanged" disabled="@(address.afinished == 1)" id="aSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                    <a class="waves-effect waves-light btn aFinished" disabled="@(address.afinished == 1)" id="aFinished_@address.id"><i class="material-icons left">check</i>Aktivirung finished</a>
                    <a class="waves-effect waves-light btn aAddImage" disabled="@(address.afinished == 1)" id="aAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>
                    </div>*@

                        <div class="row">
                            <div class="col s12 m6 l6" style="border-right: 1px solid #e0e0e0">
                                <h6><b>Aktivirung information</b></h6>
                                <span>Aktivirung finish date: </span><span id="aDate_@address.id">@address.adate</span>
                                <br>
                                <a class="waves-effect waves-light btn aFinished" disabled="@(address.afinished == 1)" id="aFinished_@address.id"><i class="material-icons left">check</i>Aktivirung finished</a>
                                <a class="waves-effect waves-light btn aAddImage" disabled="@(address.afinished == 1)" id="aAddImage_@address.id"><i class="material-icons left">image</i>Add image</a>

                            </div>
                            <div class="col s12 m6 l6">
                                <h6><b>Aktivirung comment</b></h6>
                                <textarea class="materialize-textarea" id="aComment_@address.id">@address.acomment</textarea>
                                @*<label for="fComment_@address.id">Aktivirung comment</label>*@
                                <a class="waves-effect waves-light btn aSaveChanges" disabled="@(address.afinished == 1)" id="aSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                            </div>
                        </div>

                    </div>

                    <div id="vermessung_@address.id" class="col s12">

                        @*<div class="row">
                    <div class="col s12 m12 l12">
                    <div class="row">
                    <div class="col s6 m6 l6">
                    <p>Date: <span id="vDate_@address.id">@address.vdate</span></p>
                    </div>
                    <div class="col s6 m6 l6">
                    <textarea class="materialize-textarea" id="vComment_@address.id">@address.vcomment</textarea>
                    <label for="vComment_@address.id">Vermessung comment</label>
                    </div>
                    </div>
                    </div>
                    <div class="card-action">
                    <a class="waves-effect waves-light btn vSaveChanges" disabled="@(address.vfinished == 1)" id="vSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                    <a class="waves-effect waves-light btn vFinished" disabled="@(address.vfinished == 1)" id="vFinished_@address.id"><i class="material-icons left">check</i>Vermessung finished</a>
                    </div>
                    </div>*@

                        <div class="row">
                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0">
                                <h6><b>Vermessung information</b></h6>
                                <span>Vermessung finish date: </span><span id="vDate_@address.id">@address.vdate</span>
                                <br>
                                <a class="waves-effect waves-light btn vFinished" disabled="@(address.vfinished == 1)" id="vFinished_@address.id"><i class="material-icons left">check</i>Vermessung finished</a>

                            </div>
                            <div class="col s12 m4 l4" style="border-right: 1px solid #e0e0e0">
                                <h6><b>Vermessung comment</b></h6>
                                <textarea class="materialize-textarea" id="vComment_@address.id">@address.vcomment</textarea>

                                <a class="waves-effect waves-light btn vSaveChanges" disabled="@(address.vfinished == 1)" id="vSaveChanges_@address.id"><i class="material-icons left">check</i>Save changes</a>
                            </div>
                            <div class="col s12 m4 l4">
                                <h6><b>Vermessung final report</b></h6>
                            </div>
                        </div>


                    </div>
                </div>



                @* <a id="hausbegehungLink">Hausbegehung</a>
            <a id="tiefbauLink">Tiefbau</a>
            <a id="faserLink">Faser</a>
            <a id="montazeLink">Montaze</a>
            <a id="aktivirungLink">Aktivirung</a>
            <a id="vermessungLink">Vermessung</a>

            <div class="row" id="hausbegehungBody">
            <div class="col s12 m12 l12">
            <div class="row">
            <div class="col s6 m6 l6">
            <p>Date: @address.hbdate?.ToString("dd.MM.yyyy")</p>
            <p>Termin: @address.hbfrom?.ToString("HH:mm") - @address.hbto?.ToString("HH:mm")</p>
            <p>Call date: <span id="hbCallDate">@address.hbcalldate?.ToString("dd.MM.yyyy HH:mm")</span></p>
            </div>
            <div class="col s6 m6 l6">
            <textarea class="materialize-textarea" id="hbComment">@address.hbcomment</textarea>
            <label for="hbComment">Hausbegehung comment</label>

            </div>
            </div>

            <a class="waves-effect waves-light btn save-changes-btn" disabled="@(address.hbfinished == 1)" href="#" id="hbSaveChanges"><i class="material-icons left">check</i>Save changes</a>
            <a class="waves-effect waves-light btn" disabled="@(address.hbfinished == 1)" href="#" id="hbFinished"><i class="material-icons left">check</i>HB finished</a>
            <a class="waves-effect waves-light btn term-btn" disabled="@(address.hbfinished == 1)" id="hbGetTerm"><i class="material-icons left">date_range</i>Get HB term</a>
            <a class="waves-effect waves-light btn call-btn" disabled="@(address.hbcalldate != null)" href="#" id="hbCustomerCalled"><i class="material-icons left">phone</i>Customer called</a>
            <a class="waves-effect waves-light btn image-btn" disabled="@(address.hbfinished == 1)" href="#" id="hbAddImages"><i class="material-icons left">image</i>Add image</a>
            </div>
            </div>

            <div class="row" id="tiefbauBody">

            <div class="col s12 m12 l12">

            <div class="row">
            <div class="col s6 m6 l6">
            <textarea class="materialize-textarea" id="meterInput">@address.meter</textarea>
            <label for="meterInput">Meter</label>

            </div>
            <div class="col s6 m6 l6">
            <textarea class="materialize-textarea" id="tCommentInput">@address.tcomment</textarea>
            <label for="tCommentInput">Tiefbau comment</label>

            </div>
            </div>
            <div class="row">
            <div class="col s12 m12 l12">
            <p>Date: <span id="tDate">@address.tdate</span></p>
            </div>
            </div>

            </div>

            <a class="waves-effect waves-light btn save-changes-btn" disabled="@(address.tfinished == 1)" href="#" id="tSaveChanges"><i class="material-icons left">check</i>Save changes</a>
            <a class="waves-effect waves-light btn finished-btn" disabled="@(address.tfinished == 1)" href="#" id="tFinished"><i class="material-icons left">check</i>Tiefbau finished</a>

            </div>*@

            </div>
        </li>
        @*    <li>
    <div class="collapsible-header"><i class="material-icons">place</i>Second</div>
    <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
    </li>
    <li>
    <div class="collapsible-header"><i class="material-icons">whatshot</i>Third</div>
    <div class="collapsible-body"><span>Lorem ipsum dolor sit amet.</span></div>
    </li>*@


        @*      <tr >


    <td>@d.name</td>
    <td>@d.email</td>
    <td>@d.phone</td>
    <td>@d.phone2</td>
    <td>@d.city</td>
    <td>@d.tzip</td>
    <td>@d.street</td>
    <td>@d.housenumber</td>
    <td>@d.unit</td>
    <td>@d.areapop</td>
    <th>
    @if (d.hbfinished == 1)
    {
    <i class="material-icons left">check</i>
    }
    </th>

    <th>
    @if (d.tfinished == 1)
    {
    <i class="material-icons left">check</i>
    }
    </th>
    <th>
    @if (d.ffinished == 1)
    {
    <i class="material-icons left">check</i>
    }
    </th>
    <th>
    @if (d.mfinished == 1)
    {
    <i class="material-icons left">check</i>
    }
    </th>
    <th>
    @if (d.afinished == 1)
    {
    <i class="material-icons left">check</i>
    }
    </th>
    <th>
    @if (d.vfinished == 1)
    {
    <i class="material-icons left">check</i>
    }
    </th>
    <td style="font-weight: bold;">
    @Html.ActionLink("Details",
    "AddressDetails",
    "Home",
    new { id = @d.id },
    null
    )

    </td>


    </tr>*@

    }
</ul>

@*</table>*@




@*@section Scripts{*@
@*<script type="text/javascript">
        $(function() {
            $("#submit").click(function() {
                document.forms[0].submit();
                return false;
            });
        });
    </script>*@
@*}
*@    @*@*<button id="submitAddresses" class="btn" value="Submit" type="submit">Submit</button>*@
@*@Html.ActionLink("Home","Addresses",Model)*@
@*</form>*@

@*@section Scripts{
                     <script>
$(function() {
                         $("#submitAddresses").click(function(){
                             $.ajax({
                                 url: "/Home/Addresses",
                                 method: "POST",
                                 data:  $("#addresses").serialize(),
                                 success: function(){
                                     alert("Success")
                                 },
                                 error: function(error) {
                                     alert(JSON.stringify(error))
                                 }
                             })
                         })
                          })
                     </script>
                 }*@

@section Scripts{

    <script>


        $(document).ready(
            function() {
                $('.collapsible').collapsible();
                $('.tabs').tabs();
                $('.datepicker').datepicker();
                $('.timepicker').timepicker({ twelveHour: false });

                //console.log($('.tabs'));

                //$('#hausbegehungBody').style.visibility = "visible";
                //$('#tiefbauBody').style.visibility = "hidden";

                const params = new Proxy(new URLSearchParams(window.location.search), {
                    get: (searchParams, prop) => searchParams.get(prop),
                });
                console.log(params.pop);
                // Get the value of "some_key" in eg "https://example.com/?some_key=some_value"
                //let pop = params.pop;

                if (params.pop)
                    $("#popFilter")[0].value = params.pop;

                console.log(params.hbFinished);
                console.log(params.tFinished);
                console.log(params.fFinished);
                console.log(params.mFinished);
                console.log(params.aFinished);
                console.log(params.vFinished);

                //    $("#hbFilter")[0].checked = params.hbFinished;
                //$("#tFilter")[0].checked = params.tFinished;
                //$("#fFilter")[0].checked = params.fFinished;
                //$("#mFilter")[0].checked = params.mFinished;
                //$("#aFilter")[0].checked = params.aFinished;
                //    $("#vFilter")[0].checked = params.vFinished;
                //;

                //$("#hbFilter").prop("checked", params.hbFinished);
                // $("#tFilter").prop("checked", params.tFinished);
                //  $("#fFilter").prop("checked", params.fFinished);
                //   $("#mFilter").prop("checked", params.mFinished);
                //    $("#aFilter").prop("checked", params.aFinished);
                //     $("#vFilter").prop("checked", params.vFinished);
                //$("#hbFilter")[0].val(params.hbFinished);
                //$("#hbFilter")[0].val(params.hbFinished);
            })

        $(".hbTerms").on("click", function() {

            var city = this.id.split(' ')[0];

            var pop = this.id.split(' ')[1];

            var address_id = this.id.split(' ')[2];


            var year = new Date().getFullYear();
            var month = new Date().getMonth() + 1;
            var date = new Date().getDate();

            //getThreeDaysTerms(address_id, city, pop, year, month, date);

            //var date1 = new Date();
            //date1.setDate(date1.getDate() + 1);

            //var year1 = date1.getFullYear();
            //var month1 = date1.getMonth() + 1;
            //var date1 = date1.getDate();

            //var date2 = new Date();
            //date2.setDate(date2.getDate() + 2);

            //var year2 = date2.getFullYear();
            //var month2 = date2.getMonth() + 1;
            //var date2 = date2.getDate();

            ////console.log(year);
            ////console.log(month);
            ////console.log(date);

            //$.ajax({
            //    type: "GET",
            //    url: "/api/HausbegehungTerm/" + city + "/" + pop + "/" + year + "/" + month + "/" + date,

            //    contentType: "application/json; charset=utf-8",

            //    success: function(r) {
            //        console.log(r);
            //        console.log(address_id);
            //        $("#tblHbTerms tbody tr").remove();
            //        //alert("Successfully added new hb term!");
            //        //var toastHTML = '<span>Successfully added new hb term!</span>';
            //        //M.toast({ html: toastHTML });
            //        //console.log(r);
            //        //$('#tblHbTerms tbody').append("<tr id=\"tr_" + r.id + "\"><td hidden><input type=\"text\" value=\"" + r.id + "\" /></td><td>" + timeFrom + "</td><td>" + timeTo + "</td><td></td><td><a class=\"btn btn-danger btnRemove\" id=\"btnRemove_" + r.id + "\" ><i class=\"material-icons left\">close</i>Remove</a></td></tr>");
            //        for (i = 0; i < r.length; i++) {
            //            console.log("Disabled");
            //            console.log(r[i].busy == 1);

            //            $('#tblHbTerms tbody').append("<tr><td hidden></td><td>" + new Date(r[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
            //            if (r[i].busy == 1) {
            //                console.log($('#btnReserve_' + address_id + '_' + r[i].id));
            //                $('#btnReserve_' + address_id + '_' + r[i].id).attr('disabled', 'disabled');
            //            }


            //        }


            //    },
            //    error: function(err) {
            //        //alert("Error. Please, try again!");
            //        //console.log(JSON.stringify(err))
            //        //var toastHTML = '<span>Error. Please, try again!</span>';
            //        //M.toast({ html: toastHTML });
            //    }
            //});

            //$.ajax({
            //    type: "GET",
            //    url: "/api/HausbegehungTerm/" + city + "/" + pop + "/" + year1 + "/" + month1 + "/" + date1,

            //    contentType: "application/json; charset=utf-8",

            //    success: function(r1) {
            //        console.log(r1);
            //        console.log(address_id);
            //        $("#tblHbTerms_1 tbody tr").remove();
            //        //alert("Successfully added new hb term!");
            //        //var toastHTML = '<span>Successfully added new hb term!</span>';
            //        //M.toast({ html: toastHTML });
            //        //console.log(r);
            //        //$('#tblHbTerms tbody').append("<tr id=\"tr_" + r.id + "\"><td hidden><input type=\"text\" value=\"" + r.id + "\" /></td><td>" + timeFrom + "</td><td>" + timeTo + "</td><td></td><td><a class=\"btn btn-danger btnRemove\" id=\"btnRemove_" + r.id + "\" ><i class=\"material-icons left\">close</i>Remove</a></td></tr>");
            //        for (i = 0; i < r1.length; i++) {
            //            console.log("Disabled");
            //            console.log(r1[i].busy == 1);

            //            $('#tblHbTerms_1 tbody').append("<tr><td hidden></td><td>" + new Date(r1[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r1[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r1[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
            //            if (r1[i].busy == 1) {
            //                console.log($('#btnReserve_' + address_id + '_' + r1[i].id));
            //                $('#btnReserve_' + address_id + '_' + r1[i].id).attr('disabled', 'disabled');
            //            }


            //        }


            //    },
            //    error: function(err) {
            //        //alert("Error. Please, try again!");
            //        //console.log(JSON.stringify(err))
            //        //var toastHTML = '<span>Error. Please, try again!</span>';
            //        //M.toast({ html: toastHTML });
            //    }
            //});


            //$.ajax({
            //    type: "GET",
            //    url: "/api/HausbegehungTerm/" + city + "/" + pop + "/" + year2 + "/" + month2 + "/" + date2,

            //    contentType: "application/json; charset=utf-8",

            //    success: function(r2) {
            //        console.log(r2);
            //        console.log(address_id);
            //        $("#tblHbTerms_2 tbody tr").remove();
            //        //alert("Successfully added new hb term!");
            //        //var toastHTML = '<span>Successfully added new hb term!</span>';
            //        //M.toast({ html: toastHTML });
            //        //console.log(r);
            //        //$('#tblHbTerms tbody').append("<tr id=\"tr_" + r.id + "\"><td hidden><input type=\"text\" value=\"" + r.id + "\" /></td><td>" + timeFrom + "</td><td>" + timeTo + "</td><td></td><td><a class=\"btn btn-danger btnRemove\" id=\"btnRemove_" + r.id + "\" ><i class=\"material-icons left\">close</i>Remove</a></td></tr>");
            //        for (i = 0; i < r2.length; i++) {
            //            //console.log("Disabled");
            //            console.log(r2[i].busy == 1);

            //            $('#tblHbTerms_2 tbody').append("<tr><td hidden></td><td>" + new Date(r2[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r2[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r2[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
            //            if (r2[i].busy == 1) {
            //                console.log($('#btnReserve_' + address_id + '_' + r2[i].id));
            //                $('#btnReserve_' + address_id + '_' + r2[i].id).attr('disabled', 'disabled');
            //            }


            //        }


            //    },
            //    error: function(err) {
            //        //alert("Error. Please, try again!");
            //        //console.log(JSON.stringify(err))
            //        //var toastHTML = '<span>Error. Please, try again!</span>';
            //        //M.toast({ html: toastHTML });
            //    }
            //});
        })

        function getThreeDaysTerms(address_id, city, pop, year, month, date) {
            //alert("Getting terms");
            var currentDate = new Date(year, month, date);

            $("#termsDate_" + address_id).val(date + "." + month + "." + year);

            var firstDate = new Date(year, month, date);
            firstDate.setDate(firstDate.getDate() + 1);

            var year1 = firstDate.getFullYear();
            var month1 = firstDate.getMonth();
            var date1 = firstDate.getDate();

            $("#termsDate_1_" + address_id).val(date1 + "." + month1 + "." + year1);

            var secondDate = new Date(year, month, date);
            secondDate.setDate(secondDate.getDate() + 2);

            var year2 = secondDate.getFullYear();
            var month2 = secondDate.getMonth();
            var date2 = secondDate.getDate();

            $("#termsDate_2_" + address_id).val(date2 + "." + month2 + "." + year2);

            $.ajax({
                type: "GET",
                url: "/api/HausbegehungTerm/" + city + "/" + pop + "/" + year + "/" + month + "/" + date,

                contentType: "application/json; charset=utf-8",

                success: function(r) {
                    //console.log("R: "); console.log(r);
                    $("#tblHbTerms tbody tr").remove(); for (i = 0; i < r.length; i++) {
                        if (r[i].busy == 1) {
                            $('#tblHbTerms tbody').append("<tr><td hidden></td><td>" + new Date(r[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td></td></tr>");
                        }
                        else {
                            $('#tblHbTerms tbody').append("<tr><td hidden></td><td>" + new Date(r[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
                        }


                        // if (r[i].busy == 1) {
                        //    console.log("Busy for address " + address_id + " and term " + r[i].id);
                        //    console.log($('#btnReserve_' + address_id + '_' + r[i].id));
                        //    //console.log($('#btnReserve_' + address_id + '_' + r[i].id));
                        //    $('#btnReserve_' + address_id + '_' + r[i].id).css('visibility', 'hidden'); //.prop( "disabled", true ); //attr('disabled', 'disabled');
                        //}
                    }
                    //$(".btnReserve").on("click", function() {
                    //    console.log("Button clicked");
                    //    console.log(this.id);
                    //    let address_id = this.id.split('_')[1];
                    //    let hb_id = this.id.split('_')[2];
                    //    console.log(address_id);
                    //    console.log(hb_id);
                    //});
                },
                error: function(err) {
                    console.log(err);
                }
            });

            $.ajax({
                type: "GET",
                url: "/api/HausbegehungTerm/" + city + "/" + pop + "/" + year1 + "/" + month1 + "/" + date1,
                contentType: "application/json; charset=utf-8",
                success: function(r1) {
                    //console.log("R1"); console.log(r1);
                    $("#tblHbTerms_1 tbody tr").remove(); for (i = 0; i < r1.length; i++) {
                        if (r1[i].busy == 1) {
                            $('#tblHbTerms_1 tbody').append("<tr><td hidden></td><td>" + new Date(r1[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r1[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td></td></tr>");
                        }
                        else {
                            $('#tblHbTerms_1 tbody').append("<tr><td hidden></td><td>" + new Date(r1[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r1[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r1[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
                        }


                        //$('#tblHbTerms_1 tbody').append("<tr><td hidden></td><td>" + new Date(r1[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r1[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r1[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r1[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
                        //if (r1[i].busy == 1) {
                        //    //console.log($('#btnReserve_' + address_id + '_' + r1[i].id));
                        //    $('#btnReserve_' + address_id + '_' + r1[i].id).attr('disabled', 'disabled');
                        //}
                    }
                    //$(".btnReserve").on("click", function() {
                    //    console.log("Button clicked");
                    //    console.log(this.id);
                    //    let address_id = this.id.split('_')[1];
                    //    let hb_id = this.id.split('_')[2];
                    //    console.log(address_id);
                    //    console.log(hb_id);
                    //});
                },
                error: function(err) {
                    console.log(err);
                }
            });


            $.ajax({
                type: "GET",
                url: "/api/HausbegehungTerm/" + city + "/" + pop + "/" + year2 + "/" + month2 + "/" + date2,
                contentType: "application/json; charset=utf-8",
                success: function(r2) {
                    //console.log("R2"); console.log(r2);
                    $("#tblHbTerms_2 tbody tr").remove();
                    for (i = 0; i < r2.length; i++) {
                        if (r2[i].busy == 1) {
                            $('#tblHbTerms_2 tbody').append("<tr><td hidden></td><td>" + new Date(r2[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r2[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td></td></tr>");
                        }
                        else {
                            $('#tblHbTerms_2 tbody').append("<tr><td hidden></td><td>" + new Date(r2[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r2[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r2[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
                        }


                        //$('#tblHbTerms_2 tbody').append("<tr><td hidden></td><td>" + new Date(r2[i].hbfrom).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbfrom).getMinutes().toString().padStart(2, '0') + "</td><td>" + new Date(r2[i].hbto).getHours().toString().padStart(2, '0') + ":" + new Date(r2[i].hbto).getMinutes().toString().padStart(2, '0') + "</td><td><a class=\"btn btnReserve\" id=\"btnReserve_" + address_id + "_" + r2[i].id + "\"><i class=\"material-icons left\">check</i>Reserve</a></td></tr>");
                        //if (r2[i].busy == 1) {
                        //    //console.log($('#btnReserve_' + address_id + '_' + r2[i].id));
                        //    $('#btnReserve_' + address_id + '_' + r2[i].id).attr('disabled', 'disabled');
                        //}
                    }
                    //$(".btnReserve").on("click", function() {
                    //    console.log("Button clicked");
                    //    console.log(this.id);
                    //    let address_id = this.id.split('_')[1];
                    //    let hb_id = this.id.split('_')[2];
                    //    console.log(address_id);
                    //    console.log(hb_id);
                    //});
                },
                error: function(err) {
                    console.log(err);
                }
            });

            // TODO: HACK
            setTimeout(() => {
                $(".btnReserve").on("click", function() {
                    console.log("Button clicked");
                    console.log(this.id);
                    let address_id = this.id.split('_')[1];
                    let hbterm_id = this.id.split('_')[2];
                    console.log(address_id);
                    console.log(hbterm_id);

                    hbReservation = {};
                    hbReservation.address_id = address_id;
                    hbReservation.hbterm_id = hbterm_id;

                    $.ajax({
                        type: "POST",
                        url: "/api/Reservation/HausbegehungTerm",
                        data: JSON.stringify(hbReservation),
                        contentType: "application/json; charset=utf-8",
                        //dataType: "json",
                        success: function(r) {
                            console.log(r);
                            var toastHTML = '<span>Successfully updated hausbegehung.</span>';
                            M.toast({ html: toastHTML });
                            //alert("Successfully updated hausbegehung.");
                            //hbCommentInput.val(hbData.hbcomment);
                            //$("#hbCustomerCalled").attr("disabled", "disabled");
                            //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                        },
                        error: function(err) {
                            var toastHTML = '<span>Error! Please try again</span>';
                            M.toast({ html: toastHTML });
                            console.log(JSON.stringify(err))
                        }
                    });

                });
            }, 2000);
        }




        //$(".btnReserve").on("click", function() {
        //    alert("Button clicked");
        //    console.log(this.id);
        //    let address_id = this.id.split('_')[1];
        //    let hb_id = this.id.split('_')[2];
        //    console.log(address_id);
        //    console.log(hb_id);

        //});

        $("#reset").on("click", function() {
            $("#popFilter")[0].value = null;
            $("#hbFilter")[0].checked = false;
            $("#tFilter")[0].checked = false;
            $("#fFilter")[0].checked = false;
            $("#mFilter")[0].checked = false;
            $("#aFilter")[0].checked = false;
            $("#vFilter")[0].checked = false;

            window.location.href = "/";

        })

        $("#filter").on('click', function() {
            var pop = $("#popFilter")[0].value;
            var city = $("#cityFilter")[0].value;
            var hbFinished = $("#hbFilter")[0].checked;
            var tFinished = $("#tFilter")[0].checked;
            var fFinished = $("#fFilter")[0].checked;
            var mFinished = $("#mFilter")[0].checked;
            var aFinished = $("#aFilter")[0].checked;
            var vFinished = $("#vFilter")[0].checked;

            var filterModel = {};
            filterModel.pop = pop;
            filterModel.city = city;
            filterModel.hbFinished = hbFinished;
            filterModel.tFinished = tFinished;
            filterModel.fFinished = fFinished;
            filterModel.mFinished = mFinished;
            filterModel.aFinished = aFinished;
            filterModel.vFinished = vFinished;

            console.log(filterModel);

            window.location.href = "/Home/Filter/?city=" + city + "pop=" + pop + "&hbfinished=" + hbFinished + "&tfinished=" + tFinished
                + "&ffinished=" + fFinished + "&mfinished=" + mFinished + "&afinished=" + aFinished + "&vfinished=" + vFinished;

            //$.ajax({
            //    type: "POST",
            //    url: "/Home/Filter/?",
            //    data: JSON.stringify(filterModel),
            //    contentType: "application/json; charset=utf-8",
            //    //dataType: "json",
            //    success: function(r) {
            //        //alert("Success");
            //        ////$("#hbGetTerm").attr("disabled", "disabled");
            //        ////$("#hbCustomerCalled").attr("disabled", "disabled");
            //        //$("#vFinished").attr("disabled", "disabled");
            //        //$("#vSaveChanges").attr("disabled", "disabled");
            //        //$("#vDate").html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());

            //        //$("#hbCustomerCalled").attr("disabled", "disabled");
            //        //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
            //    },
            //    error: function(err) {
            //        alert("Error");
            //        console.log(JSON.stringify(err))
            //    }

            //})

            //window.location.href = "/Home/Filter/?pop=" + pop + "&hbFinished=" + hbFinished + "&tFinished=" + tFinished + "&fFinished=" + fFinished + "&mFinished=" + mFinished + "&aFinished=" + aFinished + "&vFinished=" + vFinished;
            //$.ajax({
            //                     url: "/Home/Filter/?pop=" + pop + "&hbFinished=" + hbFinished  + "&tFinished=" + tFinished + "&fFinished=" + fFinished + "&mFinished=" + mFinished + "&aFinished=" + aFinished + "&vFinished=" + vFinished,
            //                     method: "GET",
            //                     success: function(){
            //                         alert("Success")
            //                     },
            //                     error: function(error) {
            //                         alert(JSON.stringify(error))
            //                     }
            //                 })

        })

        $(document).on("click", "ul.collapsible li.header_li .collapsible-header", function() {

            //alert("Collapsible clicked!");

            var address_id = this.id.split('_')[1];
            var city = $("#citySpan_" + address_id)[0].innerText;
            var pop = $("#areapopSpan_" + address_id)[0].innerText;
            var year = new Date().getFullYear();
            var month = new Date().getMonth() + 1;
            var date = new Date().getDate();

            getThreeDaysTerms(address_id, city, pop, year, month, date);

            var elem = document.querySelectorAll("ul.collapsible li.header_li");
            var index = "none"

            //console.log(elem);


            for (var i = 0; i < elem.length; i++) {
                //console.log(elem[i].className);
                if (elem[i].className.indexOf("active") != -1) {
                    //index = i;
                    //console.log(elem[i].children[0]);
                    elem[i].children[0].style.backgroundColor = '#e0e0e0';
                    //console.log(elem[i]);
                }
                else {
                    elem[i].children[0].style.backgroundColor = 'transparent';;
                }
                //document.getElementById("show").innerHTML = index;
            }




        })

        $(".hbCustomerCalled").click(function() {
            //console.log($("#addressId"));
            var addressId = this.id.split('_')[1];
            //console.log($("#addressId")[0]);
            //alert(addressId);
            var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));
            // TODO: Need logic for current time hours
            currentTime.setHours(currentTime.getHours() + 2);
            var hbData = {};
            hbData.calldate = currentTime;

            $.ajax({
                type: "PUT",
                url: "/api/Hausbegehung/" + addressId,
                data: JSON.stringify(hbData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully checked customer called!");
                    var toastHTML = '<span>Successfully checked customer called!</span>';
                    M.toast({ html: toastHTML });
                    // $("#hbCustomerCalled_" + addressId).attr("disabled", "disabled");
                    $("#hbCallDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + (currentTime.getHours() - 2) + ':' + currentTime.getMinutes());
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".hbSaveChanges").click(function() {
            var addressId = this.id.split('_')[1];
            let hbCommentInput = $("#hbComment_" + addressId)[0];
            console.log(hbCommentInput.value);
            //alert(addressId);
            //var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            var hbData = {};
            hbData.hbcomment = hbCommentInput.value;



            $.ajax({
                type: "PUT",
                url: "/api/Hausbegehung/" + addressId,
                data: JSON.stringify(hbData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully updated hausbegehung.");
                    var toastHTML = '<span>Successfully updated hausbegehung!</span>';
                    M.toast({ html: toastHTML });
                    //hbCommentInput.val(hbData.hbcomment);
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error! Please try again.");
                    var toastHTML = '<span>Error! Please, try again.</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".hbFinished").click(function() {

            var hbData = {};
            hbData.finished = 1;

            var addressId = this.id.split('_')[1];
            $.ajax({
                type: "PUT",
                url: "/api/Hausbegehung/" + addressId,
                data: JSON.stringify(hbData),
                contentType: "application/json; charset=utf-8",

                success: function(r) {
                    //alert("Successfully checked hb finished!");
                    var toastHTML = '<span>Successfully checked hb finished!</span>';
                    M.toast({ html: toastHTML });
                    $("#hbGetTerm_" + addressId).attr("disabled", "disabled");
                    $("#hbCustomerCalled_" + addressId).attr("disabled", "disabled");
                    $("#hbFinished_" + addressId).attr("disabled", "disabled");
                    $("#hbSaveChanges_" + addressId).attr("disabled", "disabled");
                    $("#hbAddImage_" + addressId).attr("disabled", "disabled");
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".hbGetTerm").click(function() {
            // CHANGED THIS - this button will be removed
            //var addressId = $("#addressId")[0].innerText;
            var addressId = this.id.split('_')[1];
            //window.location.href = "/Hausbegehung/Reserve/?id=" + addressId;
            window.open("/Hausbegehung/Reserve/?id=" + addressId, "_blank");
            return;

            var currentTime = new Date();
            let date = currentTime.getFullYear() + '-' + (currentTime.getMonth().toFixed() - 1) + '-' + currentTime.getDate();
            window.location.href = "/Hausbegehung/Terms/?address_id=" + addressId + '&year=' + currentTime.getFullYear() + '&month=' + (currentTime.getMonth().toFixed()) + '&date=' + currentTime.getDate();
        })

        $(".hbAddImage").click(function() {
            //var addressId = $("#addressId")[0].innerText;
            var addressId = this.id.split('_')[1];
            window.location.href = "/StreamFileUpload/?type=hausbegehung&address_id=" + addressId;
        })

        $(".tSaveChanges").click(function() {
            var addressId = this.id.split('_')[1];

            let tComment = $("#tComment_" + addressId)[0];

            let meter = $("#meter_" + addressId)[0];

            var tData = {};
            tData.tcomment = tComment.value;
            tData.meter = meter.value;


            $.ajax({
                type: "PUT",
                url: "/api/Tiefbau/" + addressId,
                data: JSON.stringify(tData),
                contentType: "application/json; charset=utf-8",
                success: function(r) {
                    //alert("Successfully saved tiefbau data!");
                    var toastHTML = '<span>Successfully saved tiefbau data!</span>';
                    M.toast({ html: toastHTML });
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".tFinished").click(function() {

            var tData = {};
            tData.finished = 1;

            var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            //tData.tdate = currentTime;

            var addressId = this.id.split('_')[1];

            $.ajax({
                type: "PUT",
                url: "/api/Tiefbau/" + addressId,
                data: JSON.stringify(tData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully checked tiefbau finished!");
                    var toastHTML = '<span>Successfully checked tiefbau finished!</span>';
                    M.toast({ html: toastHTML });
                    $("#tFinished_" + addressId).attr("disabled", "disabled");
                    $("#tReady_" + addressId).attr("disabled", "disabled");
                    $("#tSaveChanges_" + addressId).attr("disabled", "disabled");
                    $("#tSaveChanges1_" + addressId).attr("disabled", "disabled");
                    $("#tAddImage_" + addressId).attr("disabled", "disabled");
                    //$("#tDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".tReady").click(function() {

            var tData = {};
            tData.ready = 1;

            var addressId = this.id.split('_')[1];

            $.ajax({
                type: "PUT",
                url: "/api/Tiefbau/" + addressId,
                data: JSON.stringify(tData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully checked tiefbau finished!");
                    var toastHTML = '<span>Successfully checked tiefbau ready!</span>';
                    M.toast({ html: toastHTML });
                    $("#tFinished_" + addressId).removeAttr("disabled");
                    $("#tReady_" + addressId).attr("disabled", "disabled");
                    $("#tSaveChanges_" + addressId).removeAttr("disabled");
                    $("#tSaveChanges1_" + addressId).removeAttr("disabled");
                    $("#tAddImage_" + addressId).removeAttr("disabled");
                    //$("#tDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })


        $(".tAddImage").click(function() {
            //var addressId = $("#addressId")[0].innerText;
            var addressId = this.id.split('_')[1];
            window.location.href = "/StreamFileUpload/?type=tiefbau&address_id=" + addressId;
        })

        $(".fSaveChanges").click(function() {
            var addressId = this.id.split('_')[1];
            let fComment = $("#fComment_" + addressId)[0];

            var fData = {};
            fData.fcomment = fComment.value;

            $.ajax({
                type: "PUT",
                url: "/api/Faser/" + addressId,
                data: JSON.stringify(fData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully saved faser data!");
                    var toastHTML = '<span>Successfully saved faser data!</span>';
                    M.toast({ html: toastHTML });
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again.</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".fFinished").click(function() {
            var addressId = this.id.split('_')[1];

            var fData = {};
            fData.finished = 1;

            var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            fData.fdate = currentTime;

            $.ajax({
                type: "PUT",
                url: "/api/Faser/" + addressId,
                data: JSON.stringify(fData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully checked faser finished!");
                    var toastHTML = '<span>Successfully checked faser finished!</span>';
                    M.toast({ html: toastHTML });
                    $("#fFinished_" + addressId).attr("disabled", "disabled");
                    $("#fSaveChanges_" + addressId).attr("disabled", "disabled");
                    $("#fAddImage_" + addressId).attr("disabled", "disabled");
                    $("#fDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());

                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again.</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })


        $(".fAddImage").click(function() {
            //var addressId = $("#addressId")[0].innerText;
            var addressId = this.id.split('_')[1];
            window.location.href = "/StreamFileUpload/?type=faser&address_id=" + addressId;
        })


        $(".mCustomerCalled").click(function() {

            var addressId = this.id.split('_')[1];
            //alert(addressId);
            var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));
            currentTime.setHours(currentTime.getHours() + 2);
            var mData = {};
            mData.calldate = currentTime;

            $.ajax({
                type: "PUT",
                url: "/api/Montaze/" + addressId,
                data: JSON.stringify(mData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully checked customer called!");
                    var toastHTML = '<span>Successfully checked customer called!</span>';
                    M.toast({ html: toastHTML });
                    //$("#mCustomerCalled_" + addressId).attr("disabled", "disabled");
                    //$("#mCallDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());
                    $("#mCallDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + (currentTime.getHours() - 2) + ':' + currentTime.getMinutes());

                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again.</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        });

        $(".mSaveChanges").click(function() {
            var addressId = this.id.split('_')[1];
            let mComment = $("#mComment_" + addressId)[0];

            var mData = {};
            mData.mcomment = mComment.value;


            $.ajax({
                type: "PUT",
                url: "/api/Montaze/" + addressId,
                data: JSON.stringify(mData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully saved montaze data!");
                    var toastHTML = '<span>Successfully saved montaze data!</span>';
                    M.toast({ html: toastHTML });
                    //mCommentInput.val(mData.mcomment);
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again.</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".mFinished").click(function() {


            var mData = {};
            mData.finished = 1;

            var addressId = this.id.split('_')[1];

            $.ajax({
                type: "PUT",
                url: "/api/Montaze/" + addressId,
                data: JSON.stringify(mData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully checked montaze finished!");
                    var toastHTML = '<span>Successfully checked montaze finished!</span>';
                    M.toast({ html: toastHTML });
                    $("#mGetTerm_" + addressId).attr("disabled", "disabled");
                    $("#mCustomerCalled_" + addressId).attr("disabled", "disabled");
                    $("#mFinished_" + addressId).attr("disabled", "disabled");
                    $("#mSaveChanges_" + addressId).attr("disabled", "disabled");
                    $("#mAddImage_" + addressId).attr("disabled", "disabled");
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error! Please, try again.");
                    var toastHTML = '<span>Error! Please, try again.</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".mGetTerm").click(function() {
            var addressId = this.id.split('_')[1];

            //window.location.href = "/Hausbegehung/Reserve/?id=" + addressId;
            window.open("/Montaze/Reserve/?id=" + addressId, "_blank");
            return;

            var currentTime = new Date();
            let date = currentTime.getFullYear() + '-' + (currentTime.getMonth().toFixed() - 1) + '-' + currentTime.getDate();
            window.location.href = "/Montaze/Terms/?address_id=" + addressId + '&year=' + currentTime.getFullYear() + '&month=' + (currentTime.getMonth().toFixed()) + '&date=' + currentTime.getDate();
        })

        $(".mAddImage").click(function() {
            var addressId = this.id.split('_')[1];
            window.location.href = "/StreamFileUpload/?type=montaze&address_id=" + addressId;
        })



        $(".aSaveChanges").click(function() {
            //console.log($("#hbComment"));
            //var addressId = $("#addressId")[0].innerText;
            var addressId = this.id.split('_')[1];

            let aComment = $("#aComment_" + addressId)[0];
            //console.log(aCommentInput.value);

            //alert(addressId);
            //var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            var aData = {};
            aData.acomment = aComment.value;


            // var addressId = $("#addressId")[0].innerText;

            $.ajax({
                type: "PUT",
                url: "/api/Aktivirung/" + addressId,
                data: JSON.stringify(aData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Successfully saved aktivirung data!");
                    var toastHTML = '<span>Successfully saved aktivirung data!</span>';
                    M.toast({ html: toastHTML });
                    //hbCommentInput.val(hbData.comment);
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error");
                    var toastHTML = '<span>Error!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".aFinished").click(function() {
            //console.log($("#hbComment"));
            //var addressId = $("#addressId")[0].innerText;
            //let hbCommentInput = $("#hbComment")[0];
            //console.log(hbCommentInput.value);
            //alert(addressId);
            //var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));
            var addressId = this.id.split('_')[1];
            var aData = {};
            aData.finished = 1;

            //var addressId = $("#addressId")[0].innerText;

            var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            aData.adate = currentTime;

            $.ajax({
                type: "PUT",
                url: "/api/Aktivirung/" + addressId,
                data: JSON.stringify(aData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Success");
                    var toastHTML = '<span>Successfully checked aktivirung done!</span>';
                    M.toast({ html: toastHTML });
                    //$("#hbGetTerm").attr("disabled", "disabled");
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    $("#aFinished_" + addressId).attr("disabled", "disabled");
                    $("#aSaveChanges_" + addressId).attr("disabled", "disabled");
                    $("#aAddImage_" + addressId).attr("disabled", "disabled");
                    $("#aDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());

                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error");
                    var toastHTML = '<span>Error</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        // Vermessung

        $(".vSaveChanges").click(function() {
            var addressId = this.id.split('_')[1];
            //console.log($("#hbComment"));
            //var addressId = $("#addressId")[0].innerText;
            let vComment = $("#vComment_" + addressId)[0];
            console.log(vComment.value);

            //alert(addressId);
            //var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            var vData = {};
            vData.vcomment = vComment.value;


            // var addressId = $("#addressId")[0].innerText;

            $.ajax({
                type: "PUT",
                url: "/api/Vermessung/" + addressId,
                data: JSON.stringify(vData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Success");
                    var toastHTML = '<span>Successfully saved vermessung data!</span>';
                    M.toast({ html: toastHTML });
                    //hbCommentInput.val(hbData.comment);
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error");
                    var toastHTML = '<span>Error!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })

        $(".vFinished").click(function() {
            //console.log($("#hbComment"));
            //var addressId = $("#addressId")[0].innerText;
            //let hbCommentInput = $("#hbComment")[0];
            //console.log(hbCommentInput.value);
            //alert(addressId);
            //var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));
            var addressId = this.id.split('_')[1];
            var vData = {};
            vData.finished = 1;

            //var addressId = $("#addressId")[0].innerText;

            var currentTime = new Date(); //new Date(new Date().toLocaleString("en-US", { timeZone: "Europe/Belgrade" }));

            vData.vdate = currentTime;

            $.ajax({
                type: "PUT",
                url: "/api/Vermessung/" + addressId,
                data: JSON.stringify(vData),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Success");
                    var toastHTML = '<span>Success!</span>';
                    M.toast({ html: toastHTML });
                    //$("#hbGetTerm").attr("disabled", "disabled");
                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    $("#vFinished_" + addressId).attr("disabled", "disabled");
                    $("#vSaveChanges_" + addressId).attr("disabled", "disabled");
                    $("#vAddImage_" + addressId).attr("disabled", "disabled");
                    $("#vDate_" + addressId).html(currentTime.getDate() + '.' + (currentTime.getMonth().toFixed() - 1) + '.' + currentTime.getFullYear() + ' ' + currentTime.getHours() + ':' + currentTime.getMinutes());

                    //$("#hbCustomerCalled").attr("disabled", "disabled");
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    //alert("Error");
                    var toastHTML = '<span>Error!</span>';
                    M.toast({ html: toastHTML });
                    console.log(JSON.stringify(err))
                }
            });
        })


    </script>
                                 }