@model IEnumerable<realbau_app.Models.Import.NewAddress>
@{
    ViewBag.Title = "Index";
}
<h4 class="center-align">Import from file<br /></h4>
@*<form id="addresses" asp-controller="Home" asp-action="Addresses" method="POST">*@
@* using (Html.BeginForm("Addresses", "Home", FormMethod.Post))
    {*@
<table class="table table-bordered table-responsive" id="newaddresses" style="overflow:scroll; width:500px; ">
    <tr>
        <th>Accepted</th>
        <th>Bestellnummer </th>
        <th>SP_Name </th>
        <th>Name </th>
        <th>Telefon</th>
        <th>Handy</th>
        <th>Email</th>
        <th>Ort</th>
        <th>Zipcode</th>
        <th>Straße</th>
        <th>Nummer</th>
        <th>NrZusats</th>
        <th>WeitereSusatz</th>
        <th>AnschlussStatus</th>
        <th>AccessLocation</th>
        <th>IP_ODF</th>
        <th>IP_Port</th>
        <th>TV_ODF</td>
        <th>Projectcode</th>
        <th>Kennwort</th>
        <th>Subtype</th>
    </tr>
    @foreach (var d in Model)
    {


        <tr>

            <td><input type="button" class="btn btn-primary acceptBtn" value="Accept" id="accept" /></td>
            <td>@d.Bestellnummer</td>
            <td>@d.SP_Name</td>
            <td>@d.Name</td>
            <td>@d.Telefon</td>
            <td>@d.Handy</td>
            <td>@d.Email</td>
            <td>@d.Ort</td>
            <td>@d.Zipcode</td>
            <td>@d.Straße</td>
            <td>@d.Nummer</td>
            <td>@d.NrZusatz</td>
            <td>@d.WeitereSusatz</td>
            <td>@d.AnschlussStatus</td>
            <td>@d.AccessLocation</td>
            <td>@d.IP_ODF</td>
            <td>@d.IP_Port</td>
            <td>@d.TV_ODF</td>
            <td>@d.Projectcode</td>
            <td>@d.Kennwort</td>
            <td>@d.Subtype</td>



        </tr>

    }


</table>


@*@section Scripts{*@
@*<script type="text/javascript">
        $(function() {
            $("#submit").click(function() {
                document.forms[0].submit();
                return false;
            });
        });
    </script>*@
@*}
*@    @*@*<button id="submitAddresses" class="btn" value="Submit" type="submit">Submit</button>*@
@*@Html.ActionLink("Home","Addresses",Model)*@
@*</form>*@

@*@section Scripts{
                     <script>
$(function() {
                         $("#submitAddresses").click(function(){
                             $.ajax({
                                 url: "/Home/Addresses",
                                 method: "POST",
                                 data:  $("#addresses").serialize(),
                                 success: function(){
                                     alert("Success")
                                 },
                                 error: function(error) {
                                     alert(JSON.stringify(error))
                                 }
                             })
                         })
                          })
                     </script>
                 }*@

@section Scripts{

    <script>

        $(".acceptBtn").on("click", function() {

            var row = $(this).closest("tr");
            console.log(row);
            //if (confirm("Da li ste sigurni da želite da unesete stavku?")) {
            var table = $("#newaddresses")[0];
            //console.log($('#tblHbTerms tbody'));
            //var table = $("#tblHbTerms")[0];








            var newRow = {}
            newRow.orderid = 0;
            newRow.orderdate = new Date();
            newRow.projectname = "";
            newRow.dp = 0;
            newRow.dpfinish = 0;
            newRow.popfinish = 0;
            newRow.comment = "";
            //newRow.connectiondate = null;
            //newRow.completiondate = null;
            newRow.co_id = 0;
            newRow.firstname = "";
            newRow.status = "";
            newRow.servicepackage = 0;

            //alert(row[0].children[1].textContent);
            //return;


            newRow.bestellnummer = row[0].children[1].textContent;
            newRow.provider = row[0].children[2].textContent;
            newRow.name = row[0].children[3].textContent;
            newRow.phone = row[0].children[4].textContent;
            newRow.phone2 = row[0].children[5].textContent;
            newRow.email = row[0].children[6].textContent;
            newRow.city = row[0].children[7].textContent;

            newRow.tzip = row[0].children[8].textContent;
            newRow.street = row[0].children[9].textContent;
            newRow.housenumber = row[0].children[10].textContent;
            newRow.zusat = row[0].children[11].textContent;
            newRow.unit = row[0].children[12].textContent;
            newRow.arsstatus = row[0].children[13].textContent;

            newRow.areapop = row[0].children[14].textContent;
            newRow.IP_ODF = row[0].children[15].textContent;
            newRow.IP_Port = row[0].children[16].textContent;
            newRow.TV_ODF = row[0].children[17].textContent;

            newRow.projectcode = row[0].children[18].textContent;
            newRow.kennwort = row[0].children[19].textContent;
            newRow.subtype = row[0].children[20].textContent;


            console.log(JSON.stringify(newRow));

            //$("#tblCustomers TBODY TR").each(function () {
            //                            var row = $(this);
            //                            var customer = {};
            //                            customer.Name = row.find("TD").eq(0).html();
            //                            customer.Country = row.find("TD").eq(1).html();
            //                            customers.push(customer);
            //                        });

            //Send the JSON array to Controller using AJAX.
            $.ajax({
                type: "POST",
                url: "/api/Address",
                data: JSON.stringify(newRow),
                contentType: "application/json; charset=utf-8",
                //dataType: "json",
                success: function(r) {
                    //alert("Success");
                    table.deleteRow(row[0].rowIndex);
                    //$('#tblHbTerms tbody').append("<tr><td></td><td>" + newRow.hbfrom + "</td><td>" + newRow.hbto + "</td><td></td></tr>");
                },
                error: function(err) {
                    alert("Error in address insert! Please, try again.");
                    console.log(JSON.stringify(err))
                }
            });
        });
    </script>
                                 }